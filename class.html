<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>IZONE Institute</title>
<!-- Custom CSS -->
<link rel="stylesheet" href="http://127.0.0.1/ISD_Project/assets/css/home.css">
<style>
.main {
  height: auto;
  width: calc(100% - 260px);
}

.open-popup {
  left: 35%;
}

.input-box label {
    font-weight: 600;
}

.error-message {
  color: red;
  font-style: italic;
  font-size: smaller;
  }
</style>
</head>

<body>
<div class="container">
  <div class="topbar">
    <div class="logo">
      <a href="home.html"><img id="logo" src="assets/img/izone-logo-color.png" alt="logo"></a>
    </div>
    <div class="login-btn"></div>
    <a href="index.html" class="btn">Log out</a>
  </div>
  <div class="sidebar">
    <ul>
      <li>
        <a href="student.html">
          <div>STUDENT</div>
        </a>
      </li>
      <li>
        <a href="performance.html">
          <div>PERFORMANCE</div>
        </a>
      </li>
      <li>
        <a href="class.html">
          <div>CLASS</div>
        </a>
      </li>
      <li>
        <a href="admin.html">
          <div>ADMIN</div>
        </a>
      </li>
    </ul>
  </div>
  <div class="main">
    <!-- Thanh tìm kiếm -->
    <div class="per-button">
        <button type="button" class="select-btn" id="completedBtn">Completed</button>
        <button type="button" class="select-btn" id="studyingBtn">Studying</button>
    </div>
  
    <div class="st-title">
      <div class="header">
        <h2>Class List</h2>
        <div class="box">
          <button type="button" class="search-btn add-btn">Add</button>
          <input type="text" class="search-input" id="searchInput" placeholder="Search...">
        </div>
      </div>
    <!-- Bảng danh sách học sinh -->
     
      <table class="student-table" id="classData">
        <thead>
        <tr>
          <th>Class ID</th>
          <th>Level</th>
          <th>Teacher</th>
          <th>Opening Day</th>
          <th>Ending Day</th>
          <th>Student</th>
          <th>Function</th>
        </tr>
        </thead>
        <tbody>
        <!-- Dữ liệu sinh viên sẽ được thêm vào đây bằng JavaScript -->
        </tbody>
      </table>  
    </div>
  </div>
</div>

<!-- Popup for editing class information -->
<div id="open-popup" class="open-popup">
  <div class="popup-title">
  <h2>Class</h2>
  <p class="close-add-menu">X</p>
  </div>

  <div class="st-container">
    <div class="st-box">
      <h3 class="box-content">Class Information</h3>
      <div class="st-form">
        <form id="editclassForm">
          <div class="column">
            <div class="input-box">
              <label for="editClassID">Class ID</label>
              <input type="text" id="editClassID" name="editClassID" placeholder="Loading..." readonly>
            </div>
            <div class="input-box">
              <label for="editLevel">Level</label>
              <input type="text" id="editLevel" name="editLevel" placeholder="Loading...">
              <span id="editLevelError"></span>
            </div>
            <div class="input-box">
              <label for="editStatus">Status</label>
              <input type="text" id="editStatus" name="editStatus" placeholder="Loading...">
              <span id="editStatusError"></span>
            </div>
            <div class="input-box">
              <label for="editTeacher">Teacher</label>
              <input type="text" id="editTeacher" name="editTeacher" placeholder="Loading...">
              <span id="editTeacherError"></span>
            </div>
          </div>

          <div class="column">
            <div class="input-box">
              <label for="editOpeningDay">Opening Day</label>
              <input type="date" id="editOpeningDay" name="editOpeningDay" placeholder="Loading...">
              <span id="editOpeningDayError"></span>
            </div>
            <div class="input-box">
              <label for="editEndingDay">Ending Day</label>
              <input type="date" id="editEndingDay" name="editEndingDay" placeholder="Loading..." >
              <span id="editEndingDayError"></span>
            </div>
            <div class="input-box"></div>
            <div class="input-box"></div>
          </div>
        </form>
      </div>
    </div>

   
    <div class="column">
      <!-- Save changes button -->
      <div class="change-btn" id="saveChangesBtn">Save changes</div>
    </div>
  </div>
</div>

<!-- Popup for adding class information -->
<div id="open-popup-add" class="open-popup">
  <div class="popup-title">
  <h2>Class</h2>
  <p class="close-menu">X</p>
  </div>

  <div class="st-container">
    <div class="st-box">
      <h3 class="box-content">Class Information</h3>
      <div class="classForm">
        <form id="classForm">
          <div class="column">
            <div class="input-box">
              <label for="addClassID">Class ID</label>
              <input type="text" id="addClassID" name="addClassID" placeholder="Loading..." readonly>
            </div>
            <div class="input-box">
              <label for="addLevel">Level</label>
              <input type="text" id="addLevel" name="addLevel" placeholder="Loading...">
              <span id="addLevelError"></span>
            </div>
            <div class="input-box">
              <label for="addStatus">Status</label>
              <input type="text" id="addStatus" name="addStatus" placeholder="Loading...">
              <span id="addStatusError"></span>
            </div>
            <div class="input-box">
              <label for="addTeacher">Teacher</label>
              <input type="text" id="addTeacher" name="addTeacher" placeholder="Loading...">
              <span id="addTeacherError"></span>
            </div>
          </div>

          <div class="column">
            <div class="input-box">
              <label for="addOpeningDay">Opening Day</label>
              <input type="date" id="addOpeningDay" name="addOpeningDay" placeholder="Loading...">
              <span id="addOpeningDayError"></span>
            </div>
            <div class="input-box">
              <label for="addEndingDay">Ending Day</label>
              <input type="date" id="addEndingDay" name="EndingDay" placeholder="Loading..." >
              <span id="addEndingDayError"></span>
            </div>
            <div class="input-box"></div>
            <div class="input-box"></div>
          </div>
        </form>
      </div>
    </div>

   
    <div class="column">
      <!-- Save changes button -->
      <div class="change-btn" id="saveAddsBtn">Save add</div>
    </div>
  </div>
</div>

<!-- Popup for deleting class information -->
<div id="open-popup-delete" class="change-popup">
  <div class="popup-title">
    <h2>Delete Class</h2>
  </div>
  <div class="st-container">
    <div class="st-box">
      <h3 class="box-content">Are you sure to delete this class?</h3>
    </div>
    <div class="column">
      <div class="delete-btn" id="confirmDeleteBtn">Save</div>
      <div class="cancel-btn" id="cancelDeleteBtn">Cancel</div>
    </div>
  </div>
</div>

<!-- Popup for deleting student information -->
<div id="open-popup-delete-student" class="change-popup">
  <div class="popup-title">
    <h2>Delete Student</h2>
  </div>
  <div class="st-container">
    <div class="st-box">
      <h3 class="box-content">Are you sure to delete this student?</h3>
    </div>
    <div class="column">
      <div class="delete-btn" id="confirmDeleteBtnStu">Save</div>
      <div class="cancel-btn" id="cancelDeleteBtnStu">Cancel</div>
    </div>
  </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
      let currentStatus = 'Completed'; // Biến để lưu trạng thái hiện tại, mặc định là Completed khi trang được tải lần đầu

      // Mặc định hiển thị dữ liệu với trạng thái Completed khi mới truy cập performance.html
      getClassData(currentStatus);
        
      const completedBtn = document.getElementById('completedBtn');
      const studyingBtn = document.getElementById('studyingBtn');

      completedBtn.addEventListener('click', function() {
        currentStatus = 'Completed';
        searchClass();
      });
  
      studyingBtn.addEventListener('click', function() {
        currentStatus = 'Studying';
        searchClass();
      });
  
      document.getElementById('searchInput').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
          searchClass();
        }
      });

    // Gắn sự kiện khi nhấn nút "Save changes"
    document.getElementById('saveChangesBtn').addEventListener('click', function() {
      saveChanges();
    });

    // Gắn sự kiện khi nhấn nút "Save Add "
    document.getElementById('saveAddBtn').addEventListener('click', function() {
      saveAdd();
    });

          // Hàm tìm kiếm lớp học
          function searchClass() {
        const searchInput = document.getElementById('searchInput').value.trim().toLowerCase();
        getClassData(currentStatus, searchInput); // Sử dụng biến currentStatus để truyền trạng thái hiện tại
      }

      function getClassData(status, search = '') {
        let url = `assets/php/class.php?status=${status}`;
        if (search !== '') {
          url += `&search=${search}`;
        }
        fetch(url)
          .then(response => response.json())
          .then(data => {
            const classTable = document.getElementById('classData');
            const tbody = classTable.querySelector('tbody');
            tbody.innerHTML = '';

            data.forEach(classInfo => {
              const row = document.createElement('tr');
              row.innerHTML = `
                <td>${classInfo.ClassID}</td>
                <td>${classInfo.Level}</td>
                <td>${classInfo.Teacher}</td>
                <td>${classInfo.OpeningDay}</td>
                <td>${classInfo.EndingDay}</td>
                <td>
                  <button class="search-btn list-btn" data-classid="${classInfo.ClassID}">List</button>
                </td>
                <td>
                  <button class="search-btn edit-btn" data-classid="${classInfo.ClassID}">Edit</button>
                  <button class="search-btn delete-btn" data-classid="${classInfo.ClassID}">Delete</button>
                </td>
              `;
              tbody.appendChild(row);
            });

          //Gắn sự kiện cho nút List mới tạo
          attachListEventListeners();

          // Gắn sự kiện cho nút Edit mới tạo 
          attachEditEventListeners();

          // Gắn sự kiện cho nút Delete mới tạo
          attachDeleteEventListeners();


          })
          .catch(error => console.error('Error fetching data:', error));
      }
     
    });
</script>

</body>
</html>



